<!-- Clean, responsive, light SVG-based workflow diagram -->
<style>
  .gefi-workflow-svg {
    width: 100%;
    max-width: 900px;
    display: block;
    margin: 0 auto;
  }
  .gefi-workflow-wrapper {
    background: transparent !important;
    padding: 10px 0;
    text-align: center;
  }

  /* Auto-switch colors depending on theme */
  @media (prefers-color-scheme: dark) {
    .gefi-node { fill: #ffffff !important; stroke: #777 !important; }
    .gefi-text { fill: #ffffff !important; }
    .gefi-arrow { stroke: #bbbbbb !important; }
  }
  @media (prefers-color-scheme: light) {
    .gefi-node { fill: #f9f9f9 !important; stroke: #444 !important; }
    .gefi-text { fill: #111 !important; }
    .gefi-arrow { stroke: #555 !important; }
  }
</style>

<div class="gefi-workflow-wrapper">
<svg class="gefi-workflow-svg" viewBox="0 0 1200 260">

  <!-- ========== NODES ========== -->
  <!-- Clients -->
  <rect x="40" y="60" width="240" height="60" rx="12" class="gefi-node"/>
  <text x="160" y="98" text-anchor="middle" class="gefi-text" style="font-size:20px;">
    Local Clients
  </text>
  <text x="160" y="120" text-anchor="middle" class="gefi-text" style="font-size:14px;">
    (Train privately on-device)
  </text>

  <!-- Secure Aggregation -->
  <rect x="400" y="60" width="240" height="60" rx="12" class="gefi-node"/>
  <text x="520" y="98" text-anchor="middle" class="gefi-text" style="font-size:20px;">
    Secure Aggregation
  </text>
  <text x="520" y="120" text-anchor="middle" class="gefi-text" style="font-size:14px;">
    (HE + DP + ZKPs)
  </text>

  <!-- Global Model -->
  <rect x="760" y="60" width="240" height="60" rx="12" class="gefi-node"/>
  <text x="880" y="98" text-anchor="middle" class="gefi-text" style="font-size:20px;">
    Global Model Update
  </text>
  <text x="880" y="120" text-anchor="middle" class="gefi-text" style="font-size:14px;">
    (FedAvg / FedProx)
  </text>

  <!-- Marketplace -->
  <rect x="400" y="170" width="240" height="60" rx="12" class="gefi-node"/>
  <text x="520" y="205" text-anchor="middle" class="gefi-text" style="font-size:20px;">
    Model Marketplace
  </text>
  <text x="520" y="228" text-anchor="middle" class="gefi-text" style="font-size:14px;">
    Incentives & Monetization
  </text>

  <!-- ========== ARROWS ========== -->
  <!-- Clients → Secure Aggregation -->
  <line x1="280" y1="90" x2="400" y2="90" class="gefi-arrow" stroke-width="3" marker-end="url(#arrowhead)" />

  <!-- Secure Aggregation → Global Model -->
  <line x1="640" y1="90" x2="760" y2="90" class="gefi-arrow" stroke-width="3" marker-end="url(#arrowhead)" />

  <!-- Global Model down to Marketplace -->
  <line x1="880" y1="120" x2="880" y2="170" class="gefi-arrow" stroke-width="3" marker-end="url(#arrowhead)" />

  <!-- Marketplace back to Clients -->
  <line x1="400" y1="200" x2="280" y2="200" class="gefi-arrow" stroke-width="3" marker-end="url(#arrowhead)" />
  <line x1="280" y1="200" x2="160" y2="120" class="gefi-arrow" stroke-width="3" marker-end="url(#arrowhead)" />

  <!-- ========== Marker Definition ========== -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7"
      refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" class="gefi-arrow" />
    </marker>
  </defs>
</svg>
</div>
